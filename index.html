<!DOCTYPE html>
<html>
  <head>
    <script type="module">
      import Q from './qtest.js';

      /* Configuration */
      Q.config({app: 'myApp'});

      const List1 = Q(
        /* Expandable list can be query itself. */
        'List1-UnreadableId',
        {
          Id: 'ID',
          Name: 'OData_List1_UnreadableColumnName'
        },
        'SP.Data.List1ListItem'
      );

      /* Query template generated by qgen.js */
      const List0 = Q(
        'List0-UnreadableId', 
        { /* xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx */
          Id: 'ID',
          Name: 'OData_List0_UnreadableColumnName', /*OData__x0000__x0000__x0000__x0000__x00 */
          Expanded: ['OData_List0_UnreadableExpandedColumnName', List1 ]
        },
        'SP.Data.List0ListItem'
      );

      /* Test data */
      Q.fill(List1, Q.replicate(1, i => ({Id: i, Name: 'NAME' + i})));
      Q.fill(List0, Q.replicate(1, i => ({Id: i, Name: 'NAME' + i, Expanded: Q.replicate(5, i => ({Id: i, Name: 'NAME' + i}))})));


      Q.get(List0, {filter: `${List0.Id} eq 2379`}).then(data => console.log(data));
      Q.get(List1, {filter: `${List1.Id} eq 123`}).then(data => console.log(data));

      Q.post(Q.create(List1, {Id: 777, Name: "Ben"})).then(data => console.log(data));
      
      Q.post([
        Q.create(List1, {Id: 1, Name: "Ben"}),
        Q.update(List1, 323, { Name: "Johnny"}),
        Q.delete(List1, 223)
      ])
    </script>
  </head>
  <body></body>
</html>
